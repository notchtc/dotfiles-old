#!/bin/sh
# Formats fucked up html files

if [ "$1" = "a" ]; then # Run on all files
    read -p "Do you really want to format all files? (Press Y to continue or N to exit) " -r answer
    case "$answer" in
        y|Y )
            for i in $(find . -name '*.html' -type f); do
                tidy -q -i --tidy-mark 0 --show-errors 0 --indent-spaces 4 --force-output 1 --wrap 0 -m "$i" && html-beautify -r "$i"
            done
            ;;
        n|N )
            echo "Quitting..."
            exit
            ;;
        * ) echo "Invalid input! Please input Y(es) or N(o)!"
            return
            ;;
    esac
elif [ "$1" = "f" ]; then # Run on one or multiple file(s)
    shift
    tidy -q -i --tidy-mark 0 --show-errors 0 --indent-spaces 4 --force-output 1 --wrap 0 -m "${@}" | html-beautify -r "${@}"
else
    printf "\033[32;1mHELP\033[0m\n"
    printf "Use \033[33m'htmlformat a'\033[0m to format everything in the current folder and it's subfolders.\n"
    printf "Use \033[33m'html format f'\033[0m to format just one file or multiple.\n"
    printf "Example: \033[33mhtml format f index.html directory/file.html\033[0m\n"
fi
